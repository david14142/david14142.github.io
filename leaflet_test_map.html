<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>maps with leaflet & topojson</title>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <style>
    html,body,#worldmap{
      height:100%;
    }
  </style>
</head>
<body>
  <div id="worldmap"></div>

  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="http://d3js.org/topojson.v1.min.js"></script>
  <script>
    L.TopoJSON = L.GeoJSON.extend({
    addData: function(jsonData) {
      if (jsonData.type === "Topology") {
        for (key in jsonData.objects) {
          geojson = topojson.feature(jsonData, jsonData.objects[key]);
          L.GeoJSON.prototype.addData.call(this, geojson);
        }
      }
      else {
        L.GeoJSON.prototype.addData.call(this, jsonData);
      }
    }
  });
  // Copyright (c) 2013 Ryan Clark

  // create a map object and set the view to the coordinates 44,-31 with a zoom of 10
  var map = L.map('worldmap').setView([-41.3,-185], 6);

  var topoLayer = new L.TopoJSON();

  $.getJSON('/DHB2012-S1.json')
    .done(addTopoData);

  function addTopoData(topoData){
    topoLayer.addData(topoData);
    topoLayer.addTo(map);
  }
  </script>
</body>
</html>
